System.registerDynamic("games/demo.js",[],!0,function(e,t,o){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.onInit=function(e){console.log("on game init: "+e.name),console.log("screen size: "+e.width+"x"+e.height)},e.prototype.sortObjects=function(e){e.zOrder=e.y},e}();t.GameDemo=n}),System.registerDynamic("scenes/menu/menu.js",[],!0,function(e,t,o){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.onInit=function(e){console.log("on scene init: "+e.name)},e.prototype.onActivate=function(e){console.log("on scene activate: "+e.name),e.reset(),e.sprites.plot1.active=!0},e.prototype.onDeactivate=function(e){e.game.libraries.audio.musics.menu.stop()},e.prototype.onKeyPress=function(e,t){if(console.log("scene onKeyPress: "+e.name+" - "+t),"Enter"==t){var o=e.spr("cursor1");if(o&&o.active){var n=e.systems.transition;if(n&&!n.isWorking()){n.callScene("stage1");var s=e.spr("menu-item1");e.systems.tween.blink(s.components.display.object),e.game.lib("audio").sounds.select.play()}}}},e}();t.SceneMenu=n}),System.registerDynamic("scenes/menu/sprites/menu-item1.js",[],!0,function(e,t,o){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.onPointerup=function(e,t){var o=e.scene.systems.transition;o.isWorking()||(o.callScene("stage1"),e.scene.systems.tween.blink(e.components.display.object),e.game.lib("audio").sounds.select.play())},e}();t.SceneMenuSpriteMenuItem1=n}),System.registerDynamic("scenes/menu/sprites/plot1.js",[],!0,function(e,t,o){"use strict";this||self;var n=t&&t.__generator||function(e,t){var o,n,s,i,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,n=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(s=(s=r.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){r.label=i[1];break}if(6===i[0]&&r.label<s[1]){r.label=s[1],s=i;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(i);break}s[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],n=0}finally{o=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.prototype.onUpdate=function(e){var t,o,s,i,r,a,c,l;return n(this,function(n){switch(n.label){case 0:return t=e.game,o=e.plot,s=e.scene,i=s.systems.tween,r=s.systems.motion,(a=t.libraries.audio.musics.menu).volume=1,a.play(1),(c=s.spr("title1")).components.display.object.alpha=0,c.active=!0,i.get(c.components.display.object).to({alpha:1},50).call(function(){return o.signal("fadein")}),[4,o.wait("fadein")];case 1:return n.sent(),(l=s.spr("menu-item1")).components.display.object.x=270,l.components.display.object.y=600,l.active=!0,r.moveTo(l,270,220,5,function(){return o.signal("menuitem")}),[4,o.wait("menuitem")];case 2:return n.sent(),[4,o.wait(500)];case 3:return n.sent(),s.spr("cursor1").active=!0,e.active=!1,[2]}})},e}();t.SceneMenuSpritePlot1=s}),System.registerDynamic("scenes/preload/preload.js",[],!0,function(e,t,o){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.onInit=function(e){console.log("on scene init: "+e.name)},e.prototype.onActivate=function(e){console.log("on scene activate: "+e.name);var t=e.spr("label1"),o=e.spr("progress1");o.get("display").object.scale.x=10,e.game.lib("preload").loadPacks(["pack2.pack","pack3.pack"],function(){console.log("finished loading packages"),e.game.loadScenes(["menu","stage1"],function(){console.log("finished loading scenes");navigator.userAgent.indexOf("iPad")>=0||navigator.userAgent.indexOf("iPhone");e.components.event.onPointerdown=function(){return e.game.scene=e.game.scenes.menu},t.get("display").object.text+=" (click here to continue)"},function(e){var n=.5+e/200;o.get("display").object.scale.x=420*n,t.get("display").object.text="Loading scenes ... "+Math.round(100*n)+"%"})},function(e,n){if(e>0&&n>0){var s=e/n/2;o.get("display").object.scale.x=420*s,t.get("display").object.text="Loading packages ... "+Math.round(100*s)+"%"}})},e}();t.ScenePreload=n}),System.registerDynamic("scenes/stage1/sprites/plot1.js",[],!0,function(e,t,o){"use strict";this||self;var n=t&&t.__generator||function(e,t){var o,n,s,i,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,n=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(s=(s=r.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){r.label=i[1];break}if(6===i[0]&&r.label<s[1]){r.label=s[1],s=i;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(i);break}s[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],n=0}finally{o=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.prototype.onUpdate=function(e){var t,o,s,i,r,a,c,l,u,p,y,m,f,g;return n(this,function(n){switch(n.label){case 0:return t=e.game,o=e.plot,s=e.scene,s.script,i=s.systems.tween,(r=t.libraries.audio.musics.battle).volume=1,r.play(),s.sprites.reborn1.active=!0,[4,o.wait(3e3)];case 1:return n.sent(),console.log("plot - start to send enemies ... "),(a=s.spr("enemy-a1").proxy).go(s,300,0,4),[4,o.wait(300)];case 2:return n.sent(),a.go(s,230,0,4),[4,o.wait(300)];case 3:return n.sent(),a.go(s,160,0,4),[4,o.wait(2e3)];case 4:return n.sent(),a.go(s,120,0,-4),[4,o.wait(300)];case 5:return n.sent(),a.go(s,50,0,-4),[4,o.wait(300)];case 6:return n.sent(),a.go(s,-20,0,-4),[4,o.wait(2500)];case 7:return n.sent(),(c=s.spr("enemy-b1").proxy).go(s,0,-32,4),[4,o.wait(300)];case 8:case 9:case 10:return n.sent(),c.go(s,0,-32,4),[4,o.wait(300)];case 11:return n.sent(),c.go(s,0,-32,4),[4,o.wait(3e3)];case 12:return n.sent(),(l=s.spr("enemy-c1").proxy).go(s,600,-20,2),[4,o.wait(300)];case 13:return n.sent(),l.go(s,500,-20,2),[4,o.wait(300)];case 14:return n.sent(),l.go(s,400,-20,2),[4,o.wait(300)];case 15:return n.sent(),l.go(s,300,500,2),[4,o.wait(300)];case 16:return n.sent(),l.go(s,200,500,2),[4,o.wait(300)];case 17:return n.sent(),l.go(s,100,500,2),[4,o.wait(3e3)];case 18:return n.sent(),l.go(s,100,-20,2),[4,o.wait(300)];case 19:return n.sent(),l.go(s,200,-20,2),[4,o.wait(300)];case 20:return n.sent(),l.go(s,300,-20,2),[4,o.wait(300)];case 21:return n.sent(),l.go(s,400,500,2),[4,o.wait(300)];case 22:return n.sent(),l.go(s,500,500,2),[4,o.wait(300)];case 23:return n.sent(),l.go(s,600,500,2),[4,o.wait(3e3)];case 24:case 25:case 26:case 27:return n.sent(),c.go(s,0,64,-4),[4,o.wait(300)];case 28:return n.sent(),c.go(s,0,64,-4),[4,o.wait(2500)];case 29:return n.sent(),a.go(s,120,0,-4),[4,o.wait(300)];case 30:return n.sent(),a.go(s,50,0,-4),[4,o.wait(300)];case 31:return n.sent(),a.go(s,-20,0,-4),[4,o.wait(2e3)];case 32:return n.sent(),a.go(s,300,0,4),[4,o.wait(300)];case 33:return n.sent(),a.go(s,230,0,4),[4,o.wait(300)];case 34:return n.sent(),a.go(s,160,0,4),[4,o.wait(2e3)];case 35:return n.sent(),(u=s.spr("enemy-d1").proxy).go(s,200,-100,"right"),u.go(s,400,-200,"left"),u.go(s,200,-300,"right"),u.go(s,400,-400,"left"),u.go(s,100,-500,"down"),u.go(s,500,-500,"down"),[4,o.wait(2e3)];case 36:return n.sent(),(p=s.spr("enemy-e1").proxy).go(s,0,0,1),[4,o.wait(12e3)];case 37:return n.sent(),p.go(s,0,0,-1),[4,o.wait(12e3)];case 38:return n.sent(),(y=s.spr("enemy-f1").proxy).go(s),[4,o.wait(2e3)];case 39:case 40:case 41:case 42:return n.sent(),y.go(s),[4,o.wait(2e3)];case 43:return n.sent(),y.go(s),[4,o.wait(500)];case 44:case 45:case 46:case 47:return n.sent(),c.go(s,0,64,4),[4,o.wait(300)];case 48:return n.sent(),c.go(s,0,64,4),[4,o.wait(500)];case 49:case 50:case 51:return n.sent(),y.go(s),[4,o.wait(2e3)];case 52:return n.sent(),y.go(s),[4,o.wait(500)];case 53:case 54:case 55:case 56:return n.sent(),c.go(s,0,-32,-4),[4,o.wait(300)];case 57:return n.sent(),c.go(s,0,-32,-4),[4,o.wait(500)];case 58:case 59:case 60:case 61:case 62:return n.sent(),y.go(s),[4,o.wait(2e3)];case 63:return n.sent(),i.get(r).to({volume:0},2e3).call(function(){r.stop(),o.signal("bgm-fadeout")}),[4,o.wait("bgm-fadeout")];case 64:for(n.sent(),m=1333,f=s.get("stage").y;f<m;)m-=32;return s.sys("stage").wait(0,m,function(){return o.signal("fast-scrolling")}),[4,o.wait("fast-scrolling")];case 65:return n.sent(),s.sys("stage").loop(0,5653,0,m),s.sys("stage").scroll(0,-4),t.libraries.audio.musics.boss.volume=1,t.libraries.audio.musics.boss.play(),[4,o.wait(500)];case 66:return n.sent(),(g=s.spr("boss-a1").proxy).go(s,320,-128,1),g.go(s,-128,192,1),g.go(s,768,192,1),e.active=!1,[2]}})},e}();t.SceneStage1SpritePlot1=s}),System.registerDynamic("scenes/stage1/stage1.js",[],!0,function(e,t,o){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.onInit=function(e){console.log("on scene init: "+e.name)},e.prototype.onActivate=function(e){console.log("on scene activate: "+e.name);var t=e.game.components.shooting;t.progress=0,t.score=0,t.lives=2,e.reset(),e.systems.stage.setPos(0,6688),e.systems.stage.scroll(0,-1),e.sprites.plot1.active=!0},e.prototype.onDeactivate=function(e){console.log("on scene deactivate: "+e.name),e.game.libraries.audio.musics.battle.stop(),e.game.libraries.audio.musics.boss.stop(),e.game.libraries.audio.musics.win.stop(),e.game.libraries.audio.musics.lose.stop()},e.prototype.onKeyPress=function(e,t){if("Enter"==t){e.paused=!e.paused;var o=e.game.lib("audio").musics.battle,n=e.game.lib("audio").musics.boss;e.paused?(e.get("stage").scrolling=!1,o.isPlaying()&&o.pause(),n.isPlaying()&&n.pause(),e.game.lib("audio").sounds.pause.play()):(e.get("stage").scrolling=!0,o.isPaused()&&o.resume(),n.isPaused()&&n.resume())}},e}();t.SceneStage1=n}),System.registerDynamic("sprites/bar.js",[],!0,function(e,t,o){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.prepareTexture=function(e){var t=e.scene.name+"."+(e.origin?e.origin.name:e.name),o=e.game.lib("image").getTexture(t);if(o)return o;var n="#FFFFFF";e.components["custom-display"]&&e.components["custom-display"].color&&(n=e.components["custom-display"].color.toString()).length>1&&"#"==n.charAt(0)&&parseInt(n.substring(1),16);var s=document.createElement("canvas");s.width=s.height=1;var i=s.getContext("2d");return i.fillStyle=n,i.fillRect(0,0,1,1),o=PIXI.Texture.from(s),e.game.lib("image").setTexture(t,o),o},e}();t.SpriteBar=n}),System.registerDynamic("sprites/boom.js",[],!0,function(e,t,o){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.onAnimationComplete=function(e){e.active=!1},e}();t.SpriteBoom=n}),System.registerDynamic("sprites/boss-a.js",[],!0,function(e,t,o){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.explode=function(e,t,o){for(var n=e.sys("motion"),s=t.get("display").object,i=s.x,r=s.y,a=0;a<8;a++){var c=e.getFreeSprite("enemy-bullet-a1");if(!c)break;c.components.display.object.x=i,c.components.display.object.y=r,n.moveOutside(c,o,360-45*a,-8,-8,648,488,function(e){return e.active=!1}),c.active=!0}},e.prototype.sendBomb=function(e,t,o){var n=this;if(t.active){var s=e.game.lib("script"),i=e.sys("motion"),r=e.systems.tween,a=e.spr("player1").get("display").object,c=t.get("display").object.x,l=t.get("display").object.y,u=i.getMotionAngle(c,l+20,a.x,a.y),p=s.call(this,"getFreeEnemy",e,"boss-bomb-a1");p&&(p.components.display.object.tint=16777215,p.components.display.object.x=c+10*(u>270?1:-1),p.components.display.object.y=l+20,i.moveOutside(p,o,u,-8,-8,648,488,function(e){return e.active=!1}),e.timeout(1e3+Math.round(100*Math.random())%4*1e3,function(){r.get(p.components.display.object).to({tint:16742263},200).wait(300).call(function(){p.active&&(p.active=!1)})}),null==p.components.event&&(p.components.event={}),p.components.event.onDeactivate=function(t){return n.explode(e,t,2)},p.active=!0),e.timeout(2e3+Math.round(100*Math.random())%4*1e3,function(){return n.sendBomb(e,t,o)})}},e.prototype.move=function(e,t,o){var n=this;if(t.active){var s=e.sys("motion"),i=e.game.lib("json").getJson("json/paths/boss.json");if(null!=i){var r=t.get("display").object;s.applyPath(t,r.x,r.y,o,i.nodes,function(t){return n.move(e,t,0-o)})}}},e.prototype.go=function(e,t,o,n){var s=this,i=e.game.lib("script"),r=e.sys("motion"),a=i.call(this,"getFreeEnemy",e,"boss-a1");if(a){var c=0,l=0;o<0?(c=t,l=o+256,a.active=!0):t<0?(c=t+256,l=o,a.active=!0):t>0&&o>0?(c=t-256,l=o,a.active=!0):a.active=!1,a.active&&(a.components.display.object.x=t,a.components.display.object.y=o,r.moveTo(a,c,l,2*n,function(t){s.move(e,t,n),t.active&&s.sendBomb(e,t,1)}),null==a.components.event&&(a.components.event={}),a.components.event.onDeactivate=function(t){var o=a.game.components.shooting;o.progress=o.progress+35,o.progress>=100&&(console.log("stage clear"),e.spr("game-over1").active=!0)})}},e}();t.SpriteBossA=n}),System.registerDynamic("sprites/enemy-a.js",[],!0,function(e,t,o){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.fire=function(e,t,o,n){var s=e.systems.motion,i=e.sprites.player1.get("display").object,r=s.getMotionAngle(t,o,i.x,i.y),a=e.getFreeSprite("enemy-bullet-a1");null!=a&&(a.components.display.object.x=t+4*(r>270?1:-1),a.components.display.object.y=o+8,s.moveOutside(a,n,r,-8,-8,648,488,function(){return a.active=!1}),a.active=!0)},e.prototype.go=function(e,t,o,n){var s=this,i=e.systems.motion,r=e.game.libraries.script,a=e.game.libraries.json.getJson("json/paths/deepv.json");if(null!=a&&null!=a){var c=r.call(this,"getFreeEnemy",e,"enemy-a1");c&&(c.components.display.animation.reset("down"),c.components.display.animation.play(),i.applyPath(c,t,o,n,a.nodes,function(e){return c.active=!1},function(e,t,o,n){1==t&&(e.components.display.animation.reset("up"),e.components.display.animation.play(!1))}),c.active=!0,e.timeout(500+Math.round(100*Math.random())%4*500,function(){if(0!=c.active){var t=c.get("display").object;s.fire(e,t.x,t.y+16,Math.round(Math.abs(n)+1))}}))}},e}();t.SpriteEnemyA=n}),System.registerDynamic("sprites/enemy-b.js",[],!0,function(e,t,o){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.go=function(e,t,o,n){var s=e.sys("motion"),i=e.game.lib("script"),r=e.game.lib("json").getJson("json/paths/circle.json");if(null!=r&&null!=r){var a=i.call(this,"getFreeEnemy",e,"enemy-b1");a&&(s.applyPath(a,t,o,n,r.nodes,function(e){return a.active=!1},function(e,t,o,n){var s=e.components.display.object;s.rotation=Math.atan2(n-s.y,o-s.x)}),a.active=!0)}},e}();t.SpriteEnemyB=n}),System.registerDynamic("sprites/enemy-c.js",[],!0,function(e,t,o){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.tracePlayer=function(e,t,o){var n=this,s=e.sys("motion"),i=e.spr("player1"),r=t.get("display").object,a=i.get("display").object,c=r.x,l=r.y,u=a.x,p=a.y;r.rotation=Math.atan2(p-l,u-c),!i.active||0==i.components.collision.enabled||(c-u)*(c-u)+(l-p)*(l-p)<=1e4?s.moveOutside(t,o,s.getMotionAngle(c,l,u,p),-32,-32,672,512,function(e){return e.enabled=!1}):(s.moveTo(t,u,p,o),e.timeout(500,function(){t.active&&n.tracePlayer(e,t,o)}))},e.prototype.go=function(e,t,o,n){var s=e.game.lib("script").call(this,"getFreeEnemy",e,"enemy-c1");s&&(s.components.display.object.x=t,s.components.display.object.y=o,s.active=!0,this.tracePlayer(e,s,n))},e}();t.SpriteEnemyC=n}),System.registerDynamic("sprites/enemy-d.js",[],!0,function(e,t,o){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.fire=function(e,t,o){var n=this;e.timeout(2e3,function(){if(t.active){for(var s=e.sys("stage"),i=e.sys("motion"),r=t.get("stage"),a=r.x,c=r.y,l=t.get("display").animation.current,u=0;u<3;u++)e.timeout(80*(u+1),function(){if(t.active){var n=e.getFreeSprite("enemy-bullet-b1");n&&(n.active=!0,"left"==l?(s.setSpritePos(n,a-20,c),i.moveTo(n,-20,c,o,function(e){return e.active=!1})):"right"==l?(s.setSpritePos(n,a+20,c),i.moveTo(n,660,c,o,function(e){return e.active=!1})):(s.setSpritePos(n,a,c+20),i.moveTo(n,a,e.get("stage").y+480+240,o,function(e){return e.active=!1})))}});e.timeout(2e3,function(){return n.fire(e,t,o)})}})},e.prototype.go=function(e,t,o,n){var s=e.game.lib("script").call(this,"getFreeEnemy",e,"enemy-d1"),i=e.sys("stage");s&&(s.components.shooting.hp=s.components.shooting.maxhp,s.components.display.animation.set(n),i.setSpritePos(s,e.get("stage").x+t,e.get("stage").y+o),e.timeout(2e4,function(){return s.active=!1}),s.active=!0,this.fire(e,s,4))},e}();t.SpriteEnemyD=n}),System.registerDynamic("sprites/enemy-e.js",[],!0,function(e,t,o){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.fire=function(e,t,o){var n=this,s=e.sys("motion");e.timeout(1e3,function(){if(t.active){for(var i=t.get("display").object,r=i.x,a=i.y,c=0;c<5;c++){var l=e.getFreeSprite("enemy-bullet-a1");if(!l)break;l.active=!0,l.components.display.object.x=r,l.components.display.object.y=a+28;var u=360-30*(c+1);0==c?u=315:1==c?u=295:3==c?u=245:4==c&&(u=225),s.moveOutside(l,o,u,-8,-8,648,488,function(e){return e.active=!1})}e.timeout(1e3,function(){return n.fire(e,t,o)})}})},e.prototype.go=function(e,t,o,n){var s=e.sys("motion"),i=e.game.lib("script"),r=e.game.lib("json").getJson("json/paths/hill.json");if(null!=r&&null!=r){var a=i.call(this,"getFreeEnemy",e,"enemy-e1");a&&(a.active=!0,a.components.shooting.hp=a.components.shooting.maxhp,s.applyPath(a,t,o,n,r.nodes,function(e){e.active&&s.applyPath(e,t,o,0-n,r.nodes,function(e){return e.active=!1})}),this.fire(e,a,4))}},e}();t.SpriteEnemyE=n}),System.registerDynamic("sprites/enemy-f.js",[],!0,function(e,t,o){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.go=function(e){var t=e.game.lib("script"),o=e.sys("motion"),n=e.spr("player1").get("display").object,s=n.x,i=(n.y,s+Math.round(32*Math.random())*(Math.random()>.5?1:-1)),r=t.call(this,"getFreeEnemy",e,"enemy-f1");null!=r&&(r.components.display.object.x=i,r.components.display.object.y=-20,o.moveTo(r,i,520,2,function(e){return e.active=!1},function(e,t,o){var n=e.get("motion");t%64==0&&n.speed<32&&(n.speed=2*n.speed)}),r.active=!0)},e}();t.SpriteEnemyF=n}),System.registerDynamic("sprites/enemy.js",[],!0,function(e,t,o){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.getFreeEnemy=function(e,t){var o=e.getFreeSprite(t);return o&&o.components.shooting&&o.components.shooting.maxhp&&(o.components.shooting.hp=o.components.shooting.maxhp),o},e}();t.SpriteEnemy=n}),System.registerDynamic("sprites/fps.js",[],!0,function(e,t,o){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.onUpdate=function(e){var t=e.components.display;t&&t.object&&(t.object.text=Math.round(e.game.fps).toString())},e}();t.SpriteFps=n}),System.registerDynamic("sprites/game-over.js",[],!0,function(e,t,o){"use strict";this||self;var n=t&&t.__generator||function(e,t){var o,n,s,i,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,n=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(s=(s=r.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){r.label=i[1];break}if(6===i[0]&&r.label<s[1]){r.label=s[1],s=i;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(i);break}s[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],n=0}finally{o=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.prototype.onUpdate=function(e){var t,o,s,i,r,a,c,l,u,p,y;return n(this,function(n){switch(n.label){case 0:return console.log("plot started - "+e.name),t=e.game,o=e.plot,s=e.scene,i=s.systems.tween,s.systems.motion,r=t.components.shooting,a=s.sprites.player1,[4,o.wait(100)];case 1:return n.sent(),c=s.game.libraries.audio.musics.battle,l=s.game.libraries.audio.musics.boss,u=s.game.libraries.audio.musics.win,p=s.game.libraries.audio.musics.lose,0==r.progress?[3,5]:(a&&(a.components.collision.enabled=!1),c.isPlaying()?(i.get(c).to({volume:0},2e3).call(function(){c.stop(),o.signal("bgm-fadeout")}),[4,o.wait("bgm-fadeout")]):[3,3]);case 2:return n.sent(),[3,5];case 3:return l.isPlaying()?(i.get(l).to({volume:0},2e3).call(function(){l.stop(),o.signal("bgm-fadeout")}),[4,o.wait("bgm-fadeout")]):[3,5];case 4:n.sent(),n.label=5;case 5:return r.progress>0?(u.play(1),s.spr("info1").get("display").object.text="STAGE CLEAR",s.spr("info1").active=!0):r.progress<0&&(p.play(1),s.spr("info1").get("display").object.text="GAME OVER",s.spr("info1").active=!0),0==r.progress?[3,7]:[4,o.wait(6e3)];case 6:n.sent(),(y=e.scene.systems.transition)&&y.callScene("menu"),n.label=7;case 7:return e.active=!1,[2]}})},e}();t.SpriteGameOver=s}),System.registerDynamic("sprites/reborn.js",[],!0,function(e,t,o){"use strict";this||self;var n=t&&t.__generator||function(e,t){var o,n,s,i,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,n=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(s=(s=r.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){r.label=i[1];break}if(6===i[0]&&r.label<s[1]){r.label=s[1],s=i;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(i);break}s[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],n=0}finally{o=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.prototype.onUpdate=function(e){var t,o,s,i,r;return n(this,function(n){return console.log("plot started - "+e.name),t=e.scene,o=t.systems.tween,s=t.systems.motion,i=t.game.components.shooting,r=t.sprites.player1,i.lives<=0?(i.progress=-1e3,console.log("jump to gameover..."),t.spr("game-over1").active=!0):(i.lives=i.lives-1,i.bombs=2,i.level=1,i.hp=100,i.controllable=!1,r.components.display.object.x=320,r.components.display.object.y=630,r.components.display.object.alpha=1,r.components.display.object.tint=16777215,r.components.collision.enabled=!1,r.active=!0,o.blink(r.components.display.object,3e3,function(){return r.components.collision.enabled=!0}),s.moveTo(r,320,350,10,function(){return i.controllable=!0})),e.active=!1,[2]})},e}();t.SpriteReborn=s}),System.registerDynamic("systems/shooting.js",[],!0,function(e,t,o){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.name="shooting",this.collision=null,this.keyboard=null,this.motion=null,this.tween=null,this.audio=null,this.player=null,this.profile=null}return e.prototype.init=function(e){var t=this;return this.collision=e.systems.collision,this.profile=e.components.shooting,this.collision&&(this.collision.onCollision=function(e,o){return t.handleCollision(e,o)}),this.collision?console.log("shooting system is loaded successfully"):console.log("failed to load shooting system (missing collision detection)"),!0},e.prototype.activate=function(e){this.player=null,this.keyboard=e.systems.keyboard,this.motion=e.systems.motion,this.tween=e.systems.tween,this.audio=e.game.libraries.audio;var t=e.components.shooting;t&&t.player&&(this.player=e.sprites[t.player])},e.prototype.update=function(e,t){this.handleKeyboard(e),this.collision&&this.collision.update(e,t),this.updatePlayerInfoDisplay(e)},e.prototype.updatePlayerInfoDisplay=function(e){null!=this.profile&&null!=this.profile&&(e.spr("bar1").get("display").object.scale.x=250*this.profile.hp/100,e.spr("label1").get("display").object.text="x"+this.profile.lives,e.spr("label2").get("display").object.text="x"+this.profile.bombs,e.spr("label3").get("display").object.text="Score: "+this.profile.score)},e.prototype.handleKeyboard=function(e){var t=this;if(!e.paused&&null!=this.keyboard&&null!=this.keyboard&&null!=this.player&&null!=this.player&&null!=this.profile&&null!=this.profile&&!0===this.profile.controllable){var o=window.vjoystick;if(o){var n=o.up(),s=o.down(),i=o.left(),r=o.right();n||s||i||r?(this.keyboard.states.ArrowUp=n,this.keyboard.states.ArrowDown=s,this.keyboard.states.ArrowLeft=i,this.keyboard.states.ArrowRight=r):(this.keyboard.states.ArrowUp=!1,this.keyboard.states.ArrowDown=!1,this.keyboard.states.ArrowLeft=!1,this.keyboard.states.ArrowRight=!1),this.keyboard.states.Control=!0===o.b1,this.keyboard.states.Shift=!0===o.b2}var a=this.player.components.display;if(this.player.active&&a&&a.object){var c=0,l=0;if(this.keyboard.states.ArrowUp&&(l-=4),this.keyboard.states.ArrowDown&&(l+=4),this.keyboard.states.ArrowLeft&&(c-=4),this.keyboard.states.ArrowRight&&(c+=4),0!=c||0!=l){var u=a.object.getBounds(!1);u.left+c>0&&u.right+c<e.game.width&&u.top+l>0&&u.bottom+l<e.game.height-25&&(a.object.x+=c,a.object.y+=l)}if(this.keyboard.states.Control)if((this.keyboard.ticks.Control?e.ticks-this.keyboard.ticks.Control:e.ticks)>=120){var p=e.getFreeSprite("player-bullet-a1"),y=p?p.components.display.object:null;p&&y&&this.motion&&(y.x=a.object.x,y.y=a.object.y-40,p.active=!0,this.motion.moveTo(p,y.x,-40,8,function(e){return e.active=!1}),this.audio&&this.audio.sounds.shoot.play()),this.keyboard.ticks.Control=e.ticks}if(this.keyboard.states.Shift&&this.profile&&this.profile.bombs>0&&e.getFreeSpriteCount("player-bomb1")>=3){this.profile.bombs=this.profile.bombs-1;for(var m=a.object.x-80,f=0;f<3;f++){var g=e.getFreeSprite("player-bomb1");y=g?g.components.display.object:null;if(!g||!y)break;y.x=m,y.y=688,g.active=!0,this.motion.moveTo(g,m,a.object.y-48,8,function(o){e.timeout(8e3,function(){t.motion.moveTo(o,o.get("display").object.x,-60,8,function(e){return e.active=!1})})}),m+=80}}}}},e.prototype.handleCollision=function(e,t){if(null!=this.profile&&null!=this.profile&&0!=e.active&&0!=t.active){var o=null,n=null,s=null,i=null,r=null;if(e.components.shooting&&t.components.shooting){switch(e.components.shooting.role){case"player":o=e;break;case"player-bullet":n=e;break;case"enemy":s=e;break;case"enemy-bullet":i=e;break;case"friend":r=e}switch(t.components.shooting.role){case"player":o=t;break;case"player-bullet":n=t;break;case"enemy":s=t;break;case"enemy-bullet":i=t;break;case"friend":r=t}}if(s)if((a=s.components.display.object).y-a.height/2<=0||a.x+a.width/4<=0)return;if(o&&s?(this.profile.hp-=s.components.shooting.power,this.profile.hp<0&&(this.profile.hp=0),s.components.shooting.hp-=this.profile.power,s.components.shooting.hp<0&&(s.components.shooting.hp=0)):o&&i?(this.profile.hp-=i.components.shooting.power,this.profile.hp<0&&(this.profile.hp=0),i.active=!1):s&&n?(s.components.shooting.hp-=n.components.shooting.power,s.components.shooting.hp<0&&(s.components.shooting.hp=0),n.active=!1):r&&i&&(i.active=!1),s&&(o||n))if(s.components.shooting.hp>0)this.tween.get(s.components.display.object).set({tint:16742263}).wait(200).set({tint:16777215}),this.audio&&this.audio.sounds.hit.play();else{var a=(c=s.scene.getFreeSprite(s.components.shooting.boom+"1"))?c.get("display"):null;c&&a&&(a.object.x=s.components.display.object.x,a.object.y=s.components.display.object.y,a.animation.onComplete=null,a.animation.reset(),a.animation.play(!1),c.active=!0),this.profile.score+=s.components.shooting.score,this.audio&&("boom-a"==s.components.shooting.boom?this.audio.sounds.boom1.play():this.audio.sounds.boom2.play()),s.active=!1}if(o&&(s||i))if(this.profile.hp>0)this.tween.get(o.components.display.object).set({tint:16742263}).wait(200).set({tint:16777215});else{var c;a=(c=o.scene.getFreeSprite("boom-b1"))?c.get("display"):null;c&&a&&(a.object.x=o.components.display.object.x,a.object.y=o.components.display.object.y,a.animation.onComplete=function(e){e.active=!1,e.scene.spr("reborn1").active=!0},a.animation.reset(),a.animation.play(!1),c.active=!0),this.audio&&this.audio.sounds.boom2.play(),o.active=!1}}},e}();t.Shooting=n});