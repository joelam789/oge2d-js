System.registerDynamic("games/demo.js",[],!0,function(e,t,n){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.onInit=function(e){console.log("on game init: "+e.name),console.log("screen size: "+e.width+"x"+e.height)},e.prototype.sortObjects=function(e){e.zOrder=e.y},e}();t.GameDemo=o}),System.registerDynamic("scenes/menu/menu.js",[],!0,function(e,t,n){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.onInit=function(e){console.log("on scene init: "+e.name)},e.prototype.onActivate=function(e){console.log("on scene activate: "+e.name),e.reset(),e.sprites.plot1.active=!0},e.prototype.onDeactivate=function(e){e.game.libraries.audio.musics.menu.stop()},e.prototype.onKeyPress=function(e,t){if(console.log("scene onKeyPress: "+e.name+" - "+t),"Enter"==t){var n=e.spr("cursor1");if(n&&n.active){var o=e.systems.transition;if(o&&!o.isWorking()){o.callScene("stage1");var s=e.spr("menu-item1");e.systems.tween.blink(s.components.display.object),e.game.lib("audio").sounds.select.play()}}}},e}();t.SceneMenu=o}),System.registerDynamic("scenes/menu/sprites/menu-item1.js",[],!0,function(e,t,n){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.onPointerup=function(e,t){var n=e.scene.systems.transition;n.isWorking()||(n.callScene("stage1"),e.scene.systems.tween.blink(e.components.display.object),e.game.lib("audio").sounds.select.play())},e}();t.SceneMenuSpriteMenuItem1=o}),System.registerDynamic("scenes/menu/sprites/plot1.js",[],!0,function(e,t,n){"use strict";this||self;var o=t&&t.__generator||function(e,t){var n,o,s,i,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=2&i[0]?o.return:i[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,o=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(s=(s=r.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){r.label=i[1];break}if(6===i[0]&&r.label<s[1]){r.label=s[1],s=i;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(i);break}s[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],o=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.prototype.onUpdate=function(e){var t,n,s,i,r,a,c,l;return o(this,function(o){switch(o.label){case 0:return t=e.game,n=e.plot,s=e.scene,i=s.systems.tween,r=s.systems.motion,(a=t.libraries.audio.musics.menu).volume=1,a.play(1),(c=s.spr("title1")).components.display.object.alpha=0,c.active=!0,i.get(c.components.display.object).to({alpha:1},50).call(function(){return n.signal("fadein")}),[4,n.wait("fadein")];case 1:return o.sent(),(l=s.spr("menu-item1")).components.display.object.x=270,l.components.display.object.y=600,l.active=!0,r.moveTo(l,270,220,5,function(){return n.signal("menuitem")}),[4,n.wait("menuitem")];case 2:return o.sent(),[4,n.wait(500)];case 3:return o.sent(),s.spr("cursor1").active=!0,e.active=!1,[2]}})},e}();t.SceneMenuSpritePlot1=s}),System.registerDynamic("scenes/preload/preload.js",[],!0,function(e,t,n){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.onInit=function(e){console.log("on scene init: "+e.name)},e.prototype.onActivate=function(e){console.log("on scene activate: "+e.name);var t=e.spr("label1"),n=e.spr("progress1");n.get("display").object.scale.x=10,e.game.lib("preload").loadPacks(["pack2.pack","pack3.pack"],function(){console.log("finished loading packages"),e.game.loadScenes(["menu","stage1"],function(){console.log("finished loading scenes");navigator.userAgent.indexOf("iPad")>=0||navigator.userAgent.indexOf("iPhone");e.components.event.onPointerdown=function(){return e.game.scene=e.game.scenes.menu},t.get("display").object.text+=" (click here to continue)"},function(e){var o=.5+e/200;n.get("display").object.scale.x=420*o,t.get("display").object.text="Loading scenes ... "+Math.round(100*o)+"%"})},function(e,o){if(e>0&&o>0){var s=e/o/2;n.get("display").object.scale.x=420*s,t.get("display").object.text="Loading packages ... "+Math.round(100*s)+"%"}})},e}();t.ScenePreload=o}),System.registerDynamic("scenes/stage1/sprites/plot1.js",[],!0,function(e,t,n){"use strict";this||self;var o=t&&t.__generator||function(e,t){var n,o,s,i,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=2&i[0]?o.return:i[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,o=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(s=(s=r.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){r.label=i[1];break}if(6===i[0]&&r.label<s[1]){r.label=s[1],s=i;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(i);break}s[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],o=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.prototype.onUpdate=function(e){var t,n,s,i,r,a,c,l,u,p,m,y,f,g;return o(this,function(o){switch(o.label){case 0:return t=e.game,n=e.plot,s=e.scene,s.script,i=s.systems.tween,(r=t.libraries.audio.musics.battle).volume=1,r.play(),s.sprites.reborn1.active=!0,[4,n.wait(3e3)];case 1:return o.sent(),console.log("plot - start to send enemies ... "),(a=s.spr("enemy-a1").proxy).go(s,300,0,4),[4,n.wait(300)];case 2:return o.sent(),a.go(s,230,0,4),[4,n.wait(300)];case 3:return o.sent(),a.go(s,160,0,4),[4,n.wait(2e3)];case 4:return o.sent(),a.go(s,120,0,-4),[4,n.wait(300)];case 5:return o.sent(),a.go(s,50,0,-4),[4,n.wait(300)];case 6:return o.sent(),a.go(s,-20,0,-4),[4,n.wait(2500)];case 7:return o.sent(),(c=s.spr("enemy-b1").proxy).go(s,0,-32,4),[4,n.wait(300)];case 8:case 9:case 10:return o.sent(),c.go(s,0,-32,4),[4,n.wait(300)];case 11:return o.sent(),c.go(s,0,-32,4),[4,n.wait(3e3)];case 12:return o.sent(),(l=s.spr("enemy-c1").proxy).go(s,600,-20,2),[4,n.wait(300)];case 13:return o.sent(),l.go(s,500,-20,2),[4,n.wait(300)];case 14:return o.sent(),l.go(s,400,-20,2),[4,n.wait(300)];case 15:return o.sent(),l.go(s,300,500,2),[4,n.wait(300)];case 16:return o.sent(),l.go(s,200,500,2),[4,n.wait(300)];case 17:return o.sent(),l.go(s,100,500,2),[4,n.wait(3e3)];case 18:return o.sent(),l.go(s,100,-20,2),[4,n.wait(300)];case 19:return o.sent(),l.go(s,200,-20,2),[4,n.wait(300)];case 20:return o.sent(),l.go(s,300,-20,2),[4,n.wait(300)];case 21:return o.sent(),l.go(s,400,500,2),[4,n.wait(300)];case 22:return o.sent(),l.go(s,500,500,2),[4,n.wait(300)];case 23:return o.sent(),l.go(s,600,500,2),[4,n.wait(3e3)];case 24:case 25:case 26:case 27:return o.sent(),c.go(s,0,64,-4),[4,n.wait(300)];case 28:return o.sent(),c.go(s,0,64,-4),[4,n.wait(2500)];case 29:return o.sent(),a.go(s,120,0,-4),[4,n.wait(300)];case 30:return o.sent(),a.go(s,50,0,-4),[4,n.wait(300)];case 31:return o.sent(),a.go(s,-20,0,-4),[4,n.wait(2e3)];case 32:return o.sent(),a.go(s,300,0,4),[4,n.wait(300)];case 33:return o.sent(),a.go(s,230,0,4),[4,n.wait(300)];case 34:return o.sent(),a.go(s,160,0,4),[4,n.wait(2e3)];case 35:return o.sent(),(u=s.spr("enemy-d1").proxy).go(s,200,-100,"right"),u.go(s,400,-200,"left"),u.go(s,200,-300,"right"),u.go(s,400,-400,"left"),u.go(s,100,-500,"down"),u.go(s,500,-500,"down"),[4,n.wait(2e3)];case 36:return o.sent(),(p=s.spr("enemy-e1").proxy).go(s,0,0,1),[4,n.wait(12e3)];case 37:return o.sent(),p.go(s,0,0,-1),[4,n.wait(12e3)];case 38:return o.sent(),(m=s.spr("enemy-f1").proxy).go(s),[4,n.wait(2e3)];case 39:case 40:case 41:case 42:return o.sent(),m.go(s),[4,n.wait(2e3)];case 43:return o.sent(),m.go(s),[4,n.wait(500)];case 44:case 45:case 46:case 47:return o.sent(),c.go(s,0,64,4),[4,n.wait(300)];case 48:return o.sent(),c.go(s,0,64,4),[4,n.wait(500)];case 49:case 50:case 51:return o.sent(),m.go(s),[4,n.wait(2e3)];case 52:return o.sent(),m.go(s),[4,n.wait(500)];case 53:case 54:case 55:case 56:return o.sent(),c.go(s,0,-32,-4),[4,n.wait(300)];case 57:return o.sent(),c.go(s,0,-32,-4),[4,n.wait(500)];case 58:case 59:case 60:case 61:case 62:return o.sent(),m.go(s),[4,n.wait(2e3)];case 63:return o.sent(),i.get(r).to({volume:0},2e3).call(function(){r.stop(),n.signal("bgm-fadeout")}),[4,n.wait("bgm-fadeout")];case 64:for(o.sent(),y=1333,f=s.get("stage").y;f<y;)y-=32;return s.sys("stage").wait(0,y,function(){return n.signal("fast-scrolling")}),[4,n.wait("fast-scrolling")];case 65:return o.sent(),s.sys("stage").loop(0,5653,0,y),s.sys("stage").scroll(0,-4),t.libraries.audio.musics.boss.volume=1,t.libraries.audio.musics.boss.play(),[4,n.wait(500)];case 66:return o.sent(),(g=s.spr("boss-a1").proxy).go(s,320,-128,1),g.go(s,-128,192,1),g.go(s,768,192,1),e.active=!1,[2]}})},e}();t.SceneStage1SpritePlot1=s}),System.registerDynamic("scenes/stage1/stage1.js",[],!0,function(e,t,n){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.onInit=function(e){console.log("on scene init: "+e.name)},e.prototype.onActivate=function(e){console.log("on scene activate: "+e.name);var t=e.game.components.shooting;t.progress=0,t.score=0,t.lives=2,e.reset(),e.systems.stage.setPos(0,6688),e.systems.stage.scroll(0,-1),e.sprites.plot1.active=!0},e.prototype.onDeactivate=function(e){console.log("on scene deactivate: "+e.name),e.game.libraries.audio.musics.battle.stop(),e.game.libraries.audio.musics.boss.stop(),e.game.libraries.audio.musics.win.stop(),e.game.libraries.audio.musics.lose.stop()},e.prototype.onKeyPress=function(e,t){if("Enter"==t){e.paused=!e.paused;var n=e.game.lib("audio").musics.battle,o=e.game.lib("audio").musics.boss;e.paused?(e.get("stage").scrolling=!1,n.isPlaying()&&n.pause(),o.isPlaying()&&o.pause(),e.game.lib("audio").sounds.pause.play()):(e.get("stage").scrolling=!0,n.isPaused()&&n.resume(),o.isPaused()&&o.resume())}},e}();t.SceneStage1=o}),System.registerDynamic("sprites/bar.js",[],!0,function(e,t,n){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.prepareTexture=function(e){var t=e.scene.name+"."+(e.origin?e.origin.name:e.name),n=e.game.lib("image").getTexture(t);if(n)return n;var o="#FFFFFF";e.components["custom-display"]&&e.components["custom-display"].color&&(o=e.components["custom-display"].color.toString()).length>1&&"#"==o.charAt(0)&&parseInt(o.substring(1),16);var s=document.createElement("canvas");s.width=s.height=1;var i=s.getContext("2d");return i.fillStyle=o,i.fillRect(0,0,1,1),n=PIXI.Texture.from(s),e.game.lib("image").setTexture(t,n),n},e}();t.SpriteBar=o}),System.registerDynamic("sprites/boom.js",[],!0,function(e,t,n){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.onAnimationComplete=function(e){e.active=!1},e}();t.SpriteBoom=o}),System.registerDynamic("sprites/boss-a.js",[],!0,function(e,t,n){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.explode=function(e,t,n){for(var o=e.sys("motion"),s=t.get("display").object,i=s.x,r=s.y,a=0;a<8;a++){var c=e.getFreeSprite("enemy-bullet-a1");if(!c)break;c.components.display.object.x=i,c.components.display.object.y=r,o.moveOutside(c,n,360-45*a,-8,-8,648,488,function(e){return e.active=!1}),c.active=!0}},e.prototype.sendBomb=function(e,t,n){var o=this;if(t.active){var s=e.game.lib("script"),i=e.sys("motion"),r=e.systems.tween,a=e.spr("player1").get("display").object,c=t.get("display").object.x,l=t.get("display").object.y,u=i.getMotionAngle(c,l+20,a.x,a.y),p=s.call(this,"getFreeEnemy",e,"boss-bomb-a1");p&&(p.components.display.object.tint=16777215,p.components.display.object.x=c+10*(u>270?1:-1),p.components.display.object.y=l+20,i.moveOutside(p,n,u,-8,-8,648,488,function(e){return e.active=!1}),e.timeout(1e3+Math.round(100*Math.random())%4*1e3,function(){r.get(p.components.display.object).to({tint:16742263},200).wait(300).call(function(){p.active&&(p.active=!1)})}),null==p.components.event&&(p.components.event={}),p.components.event.onDeactivate=function(t){return o.explode(e,t,2)},p.active=!0),e.timeout(2e3+Math.round(100*Math.random())%4*1e3,function(){return o.sendBomb(e,t,n)})}},e.prototype.move=function(e,t,n){var o=this;if(t.active){var s=e.sys("motion"),i=e.game.lib("json").getJson("json/paths/boss.json");if(null!=i){var r=t.get("display").object;s.applyPath(t,r.x,r.y,n,i.nodes,function(t){return o.move(e,t,0-n)})}}},e.prototype.go=function(e,t,n,o){var s=this,i=e.game.lib("script"),r=e.sys("motion"),a=i.call(this,"getFreeEnemy",e,"boss-a1");if(a){var c=0,l=0;n<0?(c=t,l=n+256,a.active=!0):t<0?(c=t+256,l=n,a.active=!0):t>0&&n>0?(c=t-256,l=n,a.active=!0):a.active=!1,a.active&&(a.components.display.object.x=t,a.components.display.object.y=n,r.moveTo(a,c,l,2*o,function(t){s.move(e,t,o),t.active&&s.sendBomb(e,t,1)}),null==a.components.event&&(a.components.event={}),a.components.event.onDeactivate=function(t){var n=a.game.components.shooting;n.progress=n.progress+35,n.progress>=100&&(console.log("stage clear"),e.spr("game-over1").active=!0)})}},e}();t.SpriteBossA=o}),System.registerDynamic("sprites/boy.js",[],!0,function(e,t,n){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.prepareSpriteAsync=function(e,t){var n=e.components.spine;e.game.lib("image").loadImageByType(n.png,1,function(o){o||t(null),e.game.lib("json").loadString(n.atlas,function(s){s||t(null),e.game.lib("json").loadJson(n.json,function(e){e||t(null);var n=e.spineboy,i=s,r=new PIXI.spine.core.TextureAtlas(i,function(e,t){t(o)}),a=new PIXI.spine.core.AtlasAttachmentLoader(r),c=new PIXI.spine.core.SkeletonJson(a).readSkeletonData(n),l=new PIXI.spine.Spine(c);l.state.hasAnimation("walk")&&l.state.setAnimation(0,"walk",!0),t(l)})})})},e}();t.SpriteBoy=o}),System.registerDynamic("sprites/enemy-a.js",[],!0,function(e,t,n){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.fire=function(e,t,n,o){var s=e.systems.motion,i=e.sprites.player1.get("display").object,r=s.getMotionAngle(t,n,i.x,i.y),a=e.getFreeSprite("enemy-bullet-a1");null!=a&&(a.components.display.object.x=t+4*(r>270?1:-1),a.components.display.object.y=n+8,s.moveOutside(a,o,r,-8,-8,648,488,function(){return a.active=!1}),a.active=!0)},e.prototype.go=function(e,t,n,o){var s=this,i=e.systems.motion,r=e.game.libraries.script,a=e.game.libraries.json.getJson("json/paths/deepv.json");if(null!=a&&null!=a){var c=r.call(this,"getFreeEnemy",e,"enemy-a1");c&&(c.components.display.animation.reset("down"),c.components.display.animation.play(),i.applyPath(c,t,n,o,a.nodes,function(e){return c.active=!1},function(e,t,n,o){1==t&&(e.components.display.animation.reset("up"),e.components.display.animation.play(!1))}),c.active=!0,e.timeout(500+Math.round(100*Math.random())%4*500,function(){if(0!=c.active){var t=c.get("display").object;s.fire(e,t.x,t.y+16,Math.round(Math.abs(o)+1))}}))}},e}();t.SpriteEnemyA=o}),System.registerDynamic("sprites/enemy-b.js",[],!0,function(e,t,n){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.go=function(e,t,n,o){var s=e.sys("motion"),i=e.game.lib("script"),r=e.game.lib("json").getJson("json/paths/circle.json");if(null!=r&&null!=r){var a=i.call(this,"getFreeEnemy",e,"enemy-b1");a&&(s.applyPath(a,t,n,o,r.nodes,function(e){return a.active=!1},function(e,t,n,o){var s=e.components.display.object;s.rotation=Math.atan2(o-s.y,n-s.x)}),a.active=!0)}},e}();t.SpriteEnemyB=o}),System.registerDynamic("sprites/enemy-c.js",[],!0,function(e,t,n){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.tracePlayer=function(e,t,n){var o=this,s=e.sys("motion"),i=e.spr("player1"),r=t.get("display").object,a=i.get("display").object,c=r.x,l=r.y,u=a.x,p=a.y;r.rotation=Math.atan2(p-l,u-c),!i.active||0==i.components.collision.enabled||(c-u)*(c-u)+(l-p)*(l-p)<=1e4?s.moveOutside(t,n,s.getMotionAngle(c,l,u,p),-32,-32,672,512,function(e){return e.enabled=!1}):(s.moveTo(t,u,p,n),e.timeout(500,function(){t.active&&o.tracePlayer(e,t,n)}))},e.prototype.go=function(e,t,n,o){var s=e.game.lib("script").call(this,"getFreeEnemy",e,"enemy-c1");s&&(s.components.display.object.x=t,s.components.display.object.y=n,s.active=!0,this.tracePlayer(e,s,o))},e}();t.SpriteEnemyC=o}),System.registerDynamic("sprites/enemy-d.js",[],!0,function(e,t,n){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.fire=function(e,t,n){var o=this;e.timeout(2e3,function(){if(t.active){for(var s=e.sys("stage"),i=e.sys("motion"),r=t.get("stage"),a=r.x,c=r.y,l=t.get("display").animation.current,u=0;u<3;u++)e.timeout(80*(u+1),function(){if(t.active){var o=e.getFreeSprite("enemy-bullet-b1");o&&(o.active=!0,"left"==l?(s.setSpritePos(o,a-20,c),i.moveTo(o,-20,c,n,function(e){return e.active=!1})):"right"==l?(s.setSpritePos(o,a+20,c),i.moveTo(o,660,c,n,function(e){return e.active=!1})):(s.setSpritePos(o,a,c+20),i.moveTo(o,a,e.get("stage").y+480+240,n,function(e){return e.active=!1})))}});e.timeout(2e3,function(){return o.fire(e,t,n)})}})},e.prototype.go=function(e,t,n,o){var s=e.game.lib("script").call(this,"getFreeEnemy",e,"enemy-d1"),i=e.sys("stage");s&&(s.components.shooting.hp=s.components.shooting.maxhp,s.components.display.animation.set(o),i.setSpritePos(s,e.get("stage").x+t,e.get("stage").y+n),e.timeout(2e4,function(){return s.active=!1}),s.active=!0,this.fire(e,s,4))},e}();t.SpriteEnemyD=o}),System.registerDynamic("sprites/enemy-e.js",[],!0,function(e,t,n){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.fire=function(e,t,n){var o=this,s=e.sys("motion");e.timeout(1e3,function(){if(t.active){for(var i=t.get("display").object,r=i.x,a=i.y,c=0;c<5;c++){var l=e.getFreeSprite("enemy-bullet-a1");if(!l)break;l.active=!0,l.components.display.object.x=r,l.components.display.object.y=a+28;var u=360-30*(c+1);0==c?u=315:1==c?u=295:3==c?u=245:4==c&&(u=225),s.moveOutside(l,n,u,-8,-8,648,488,function(e){return e.active=!1})}e.timeout(1e3,function(){return o.fire(e,t,n)})}})},e.prototype.go=function(e,t,n,o){var s=e.sys("motion"),i=e.game.lib("script"),r=e.game.lib("json").getJson("json/paths/hill.json");if(null!=r&&null!=r){var a=i.call(this,"getFreeEnemy",e,"enemy-e1");a&&(a.active=!0,a.components.shooting.hp=a.components.shooting.maxhp,s.applyPath(a,t,n,o,r.nodes,function(e){e.active&&s.applyPath(e,t,n,0-o,r.nodes,function(e){return e.active=!1})}),this.fire(e,a,4))}},e}();t.SpriteEnemyE=o}),System.registerDynamic("sprites/enemy-f.js",[],!0,function(e,t,n){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.go=function(e){var t=e.game.lib("script"),n=e.sys("motion"),o=e.spr("player1").get("display").object,s=o.x,i=(o.y,s+Math.round(32*Math.random())*(Math.random()>.5?1:-1)),r=t.call(this,"getFreeEnemy",e,"enemy-f1");null!=r&&(r.components.display.object.x=i,r.components.display.object.y=-20,n.moveTo(r,i,520,2,function(e){return e.active=!1},function(e,t,n){var o=e.get("motion");t%64==0&&o.speed<32&&(o.speed=2*o.speed)}),r.active=!0)},e}();t.SpriteEnemyF=o}),System.registerDynamic("sprites/enemy.js",[],!0,function(e,t,n){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.getFreeEnemy=function(e,t){var n=e.getFreeSprite(t);return n&&n.components.shooting&&n.components.shooting.maxhp&&(n.components.shooting.hp=n.components.shooting.maxhp),n},e}();t.SpriteEnemy=o}),System.registerDynamic("sprites/fps.js",[],!0,function(e,t,n){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.onUpdate=function(e){var t=e.components.display;t&&t.object&&(t.object.text=Math.round(e.game.fps).toString())},e}();t.SpriteFps=o}),System.registerDynamic("sprites/game-over.js",[],!0,function(e,t,n){"use strict";this||self;var o=t&&t.__generator||function(e,t){var n,o,s,i,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=2&i[0]?o.return:i[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,o=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(s=(s=r.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){r.label=i[1];break}if(6===i[0]&&r.label<s[1]){r.label=s[1],s=i;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(i);break}s[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],o=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.prototype.onUpdate=function(e){var t,n,s,i,r,a,c,l,u,p,m;return o(this,function(o){switch(o.label){case 0:return console.log("plot started - "+e.name),t=e.game,n=e.plot,s=e.scene,i=s.systems.tween,s.systems.motion,r=t.components.shooting,a=s.sprites.player1,[4,n.wait(100)];case 1:return o.sent(),c=s.game.libraries.audio.musics.battle,l=s.game.libraries.audio.musics.boss,u=s.game.libraries.audio.musics.win,p=s.game.libraries.audio.musics.lose,0==r.progress?[3,5]:(a&&(a.components.collision.enabled=!1),c.isPlaying()?(i.get(c).to({volume:0},2e3).call(function(){c.stop(),n.signal("bgm-fadeout")}),[4,n.wait("bgm-fadeout")]):[3,3]);case 2:return o.sent(),[3,5];case 3:return l.isPlaying()?(i.get(l).to({volume:0},2e3).call(function(){l.stop(),n.signal("bgm-fadeout")}),[4,n.wait("bgm-fadeout")]):[3,5];case 4:o.sent(),o.label=5;case 5:return r.progress>0?(u.play(1),s.spr("info1").get("display").object.text="STAGE CLEAR",s.spr("info1").active=!0):r.progress<0&&(p.play(1),s.spr("info1").get("display").object.text="GAME OVER",s.spr("info1").active=!0),0==r.progress?[3,7]:[4,n.wait(6e3)];case 6:o.sent(),(m=e.scene.systems.transition)&&m.callScene("menu"),o.label=7;case 7:return e.active=!1,[2]}})},e}();t.SpriteGameOver=s}),System.registerDynamic("sprites/reborn.js",[],!0,function(e,t,n){"use strict";this||self;var o=t&&t.__generator||function(e,t){var n,o,s,i,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=2&i[0]?o.return:i[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,o=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(s=(s=r.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){r.label=i[1];break}if(6===i[0]&&r.label<s[1]){r.label=s[1],s=i;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(i);break}s[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],o=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.prototype.onUpdate=function(e){var t,n,s,i,r;return o(this,function(o){return console.log("plot started - "+e.name),t=e.scene,n=t.systems.tween,s=t.systems.motion,i=t.game.components.shooting,r=t.sprites.player1,i.lives<=0?(i.progress=-1e3,console.log("jump to gameover..."),t.spr("game-over1").active=!0):(i.lives=i.lives-1,i.bombs=2,i.level=1,i.hp=100,i.controllable=!1,r.components.display.object.x=320,r.components.display.object.y=630,r.components.display.object.alpha=1,r.components.display.object.tint=16777215,r.components.collision.enabled=!1,r.active=!0,n.blink(r.components.display.object,3e3,function(){return r.components.collision.enabled=!0}),s.moveTo(r,320,350,10,function(){return i.controllable=!0})),e.active=!1,[2]})},e}();t.SpriteReborn=s}),System.registerDynamic("systems/shooting.js",[],!0,function(e,t,n){"use strict";this||self;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){this.name="shooting",this.collision=null,this.keyboard=null,this.motion=null,this.tween=null,this.audio=null,this.player=null,this.profile=null}return e.prototype.init=function(e){var t=this;return this.collision=e.systems.collision,this.profile=e.components.shooting,this.collision&&(this.collision.onCollision=function(e,n){return t.handleCollision(e,n)}),this.collision?console.log("shooting system is loaded successfully"):console.log("failed to load shooting system (missing collision detection)"),!0},e.prototype.activate=function(e){this.player=null,this.keyboard=e.systems.keyboard,this.motion=e.systems.motion,this.tween=e.systems.tween,this.audio=e.game.libraries.audio;var t=e.components.shooting;t&&t.player&&(this.player=e.sprites[t.player])},e.prototype.update=function(e,t){this.handleKeyboard(e),this.collision&&this.collision.update(e,t),this.updatePlayerInfoDisplay(e)},e.prototype.updatePlayerInfoDisplay=function(e){null!=this.profile&&null!=this.profile&&(e.spr("bar1").get("display").object.scale.x=250*this.profile.hp/100,e.spr("label1").get("display").object.text="x"+this.profile.lives,e.spr("label2").get("display").object.text="x"+this.profile.bombs,e.spr("label3").get("display").object.text="Score: "+this.profile.score)},e.prototype.handleKeyboard=function(e){var t=this;if(!e.paused&&null!=this.keyboard&&null!=this.keyboard&&null!=this.player&&null!=this.player&&null!=this.profile&&null!=this.profile&&!0===this.profile.controllable){var n=window.vbuttons;if(n){var o=n.up,s=n.down,i=n.left,r=n.right;o||s||i||r?(this.keyboard.states.ArrowUp=o,this.keyboard.states.ArrowDown=s,this.keyboard.states.ArrowLeft=i,this.keyboard.states.ArrowRight=r):(this.keyboard.states.ArrowUp=!1,this.keyboard.states.ArrowDown=!1,this.keyboard.states.ArrowLeft=!1,this.keyboard.states.ArrowRight=!1),this.keyboard.states.Control=!0===n.b1,this.keyboard.states.Shift=!0===n.b2}var a=this.player.components.display;if(this.player.active&&a&&a.object){var c=0,l=0;if(this.keyboard.states.ArrowUp&&(l-=4),this.keyboard.states.ArrowDown&&(l+=4),this.keyboard.states.ArrowLeft&&(c-=4),this.keyboard.states.ArrowRight&&(c+=4),0!=c||0!=l){var u=a.object.getBounds(!1);u.left+c>0&&u.right+c<e.game.width&&u.top+l>0&&u.bottom+l<e.game.height-25&&(a.object.x+=c,a.object.y+=l)}if(this.keyboard.states.Control)if((this.keyboard.ticks.Control?e.ticks-this.keyboard.ticks.Control:e.ticks)>=120){var p=e.getFreeSprite("player-bullet-a1"),m=p?p.components.display.object:null;p&&m&&this.motion&&(m.x=a.object.x,m.y=a.object.y-40,p.active=!0,this.motion.moveTo(p,m.x,-40,8,function(e){return e.active=!1}),this.audio&&this.audio.sounds.shoot.play()),this.keyboard.ticks.Control=e.ticks}if(this.keyboard.states.Shift&&this.profile&&this.profile.bombs>0&&e.getFreeSpriteCount("player-bomb1")>=3){this.profile.bombs=this.profile.bombs-1;for(var y=a.object.x-80,f=0;f<3;f++){var g=e.getFreeSprite("player-bomb1");m=g?g.components.display.object:null;if(!g||!m)break;m.x=y,m.y=688,g.active=!0,this.motion.moveTo(g,y,a.object.y-48,8,function(n){e.timeout(8e3,function(){t.motion.moveTo(n,n.get("display").object.x,-60,8,function(e){return e.active=!1})})}),y+=80}}}}},e.prototype.handleCollision=function(e,t){if(null!=this.profile&&null!=this.profile&&0!=e.active&&0!=t.active){var n=null,o=null,s=null,i=null,r=null;if(e.components.shooting&&t.components.shooting){switch(e.components.shooting.role){case"player":n=e;break;case"player-bullet":o=e;break;case"enemy":s=e;break;case"enemy-bullet":i=e;break;case"friend":r=e}switch(t.components.shooting.role){case"player":n=t;break;case"player-bullet":o=t;break;case"enemy":s=t;break;case"enemy-bullet":i=t;break;case"friend":r=t}}if(s)if((a=s.components.display.object).y-a.height/2<=0||a.x+a.width/4<=0)return;if(n&&s?(this.profile.hp-=s.components.shooting.power,this.profile.hp<0&&(this.profile.hp=0),s.components.shooting.hp-=this.profile.power,s.components.shooting.hp<0&&(s.components.shooting.hp=0)):n&&i?(this.profile.hp-=i.components.shooting.power,this.profile.hp<0&&(this.profile.hp=0),i.active=!1):s&&o?(s.components.shooting.hp-=o.components.shooting.power,s.components.shooting.hp<0&&(s.components.shooting.hp=0),o.active=!1):r&&i&&(i.active=!1),s&&(n||o))if(s.components.shooting.hp>0)this.tween.get(s.components.display.object).set({tint:16742263}).wait(200).set({tint:16777215}),this.audio&&this.audio.sounds.hit.play();else{var a=(c=s.scene.getFreeSprite(s.components.shooting.boom+"1"))?c.get("display"):null;c&&a&&(a.object.x=s.components.display.object.x,a.object.y=s.components.display.object.y,a.animation.onComplete=null,a.animation.reset(),a.animation.play(!1),c.active=!0),this.profile.score+=s.components.shooting.score,this.audio&&("boom-a"==s.components.shooting.boom?this.audio.sounds.boom1.play():this.audio.sounds.boom2.play()),s.active=!1}if(n&&(s||i))if(this.profile.hp>0)this.tween.get(n.components.display.object).set({tint:16742263}).wait(200).set({tint:16777215});else{var c;a=(c=n.scene.getFreeSprite("boom-b1"))?c.get("display"):null;c&&a&&(a.object.x=n.components.display.object.x,a.object.y=n.components.display.object.y,a.animation.onComplete=function(e){e.active=!1,e.scene.spr("reborn1").active=!0},a.animation.reset(),a.animation.play(!1),c.active=!0),this.audio&&this.audio.sounds.boom2.play(),n.active=!1}}},e}();t.Shooting=o});