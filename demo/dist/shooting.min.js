System.registerDynamic("games/demo.js",[],!0,function(a,b,c){"use strict";this||self;Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){}return a.prototype.onInit=function(a){console.log("on game init: "+a.name),console.log("screen size: "+a.width+"x"+a.height)},a.prototype.sortObjects=function(a){a.zOrder=a.y},a}();b.GameDemo=d}),System.registerDynamic("scenes/menu/menu.js",[],!0,function(a,b,c){"use strict";this||self;Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){}return a.prototype.onInit=function(a){console.log("on scene init: "+a.name)},a.prototype.onActivate=function(a){console.log("on scene activate: "+a.name),a.reset(),a.sprites.plot1.active=!0},a.prototype.onDeactivate=function(a){a.game.libraries.audio.musics.menu.stop()},a.prototype.onKeyPress=function(a,b){if(console.log("scene onKeyPress: "+a.name+" - "+b),"Enter"==b){var c=a.spr("cursor1");if(c&&c.active){var d=a.systems.transition;if(d&&!d.isWorking()){d.callScene("stage1");var e=a.spr("menu-item1");a.systems.tween.blink(e.components.display.object),a.game.lib("audio").sounds.select.play()}}}},a}();b.SceneMenu=d}),System.registerDynamic("scenes/menu/sprites/menu-item1.js",[],!0,function(a,b,c){"use strict";this||self;Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){}return a.prototype.onPointerup=function(a,b){var c=a.scene.systems.transition;if(!c.isWorking()){c.callScene("stage1");a.scene.systems.tween.blink(a.components.display.object),a.game.lib("audio").sounds.select.play()}},a}();b.SceneMenuSpriteMenuItem1=d}),System.registerDynamic("scenes/menu/sprites/plot1.js",[],!0,function(a,b,c){"use strict";var d=(this||self,b&&b.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(a){c=[6,a],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h});Object.defineProperty(b,"__esModule",{value:!0});var e=function(){function a(){}return a.prototype.onUpdate=function(a){var b,c,e,f,g,h,i,j,k;return d(this,function(d){switch(d.label){case 0:return b=a.game,c=a.plot,e=a.scene,f=e.systems.tween,g=e.systems.motion,h=b.libraries.audio.musics.menu,h.volume=1,h.play(1),i=e.spr("title1"),i.components.display.object.alpha=0,i.active=!0,f.get(i.components.display.object).to({alpha:1},50).call(function(){return c.signal("fadein")}),[4,c.wait("fadein")];case 1:return d.sent(),j=e.spr("menu-item1"),j.components.display.object.x=270,j.components.display.object.y=600,j.active=!0,g.moveTo(j,270,220,5,function(){return c.signal("menuitem")}),[4,c.wait("menuitem")];case 2:return d.sent(),[4,c.wait(500)];case 3:return d.sent(),k=e.spr("cursor1"),k.active=!0,a.active=!1,[2]}})},a}();b.SceneMenuSpritePlot1=e}),System.registerDynamic("scenes/preload/preload.js",[],!0,function(a,b,c){"use strict";this||self;Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){}return a.prototype.onInit=function(a){console.log("on scene init: "+a.name)},a.prototype.onActivate=function(a){console.log("on scene activate: "+a.name);var b=a.spr("label1"),c=a.spr("progress1");c.get("display").object.scale.x=10,a.game.lib("preload").loadPacks(["pack2.pack","pack3.pack"],function(){console.log("finished loading packages"),a.game.loadScenes(["menu","stage1"],function(){console.log("finished loading scenes"),navigator.userAgent.indexOf("iPad")>=0||navigator.userAgent.indexOf("iPhone")>=0?(a.components.event.onPointerdown=function(){return a.game.scene=a.game.scenes.menu},b.get("display").object.text+=" (click here to continue)"):a.game.scene=a.game.scenes.menu},function(a){var d=.5+a/200;c.get("display").object.scale.x=420*d,b.get("display").object.text="Loading scenes ... "+Math.round(100*d)+"%"})},function(a,d){if(a>0&&d>0){var e=a/d/2;c.get("display").object.scale.x=420*e,b.get("display").object.text="Loading packages ... "+Math.round(100*e)+"%"}})},a}();b.ScenePreload=d}),System.registerDynamic("scenes/stage1/sprites/plot1.js",[],!0,function(a,b,c){"use strict";var d=(this||self,b&&b.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(a){c=[6,a],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h});Object.defineProperty(b,"__esModule",{value:!0});var e=function(){function a(){}return a.prototype.onUpdate=function(a){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q;return d(this,function(d){switch(d.label){case 0:return b=a.game,c=a.plot,e=a.scene,f=e.script,g=e.systems.tween,h=b.libraries.audio.musics.battle,h.volume=1,h.play(),e.sprites.reborn1.active=!0,[4,c.wait(3e3)];case 1:return d.sent(),console.log("plot - start to send enemies ... "),i=e.spr("enemy-a1").proxy,i.go(e,300,0,4),[4,c.wait(300)];case 2:return d.sent(),i.go(e,230,0,4),[4,c.wait(300)];case 3:return d.sent(),i.go(e,160,0,4),[4,c.wait(2e3)];case 4:return d.sent(),i.go(e,120,0,-4),[4,c.wait(300)];case 5:return d.sent(),i.go(e,50,0,-4),[4,c.wait(300)];case 6:return d.sent(),i.go(e,-20,0,-4),[4,c.wait(2500)];case 7:return d.sent(),j=e.spr("enemy-b1").proxy,j.go(e,0,-32,4),[4,c.wait(300)];case 8:case 9:case 10:return d.sent(),j.go(e,0,-32,4),[4,c.wait(300)];case 11:return d.sent(),j.go(e,0,-32,4),[4,c.wait(3e3)];case 12:return d.sent(),k=e.spr("enemy-c1").proxy,k.go(e,600,-20,2),[4,c.wait(300)];case 13:return d.sent(),k.go(e,500,-20,2),[4,c.wait(300)];case 14:return d.sent(),k.go(e,400,-20,2),[4,c.wait(300)];case 15:return d.sent(),k.go(e,300,500,2),[4,c.wait(300)];case 16:return d.sent(),k.go(e,200,500,2),[4,c.wait(300)];case 17:return d.sent(),k.go(e,100,500,2),[4,c.wait(3e3)];case 18:return d.sent(),k.go(e,100,-20,2),[4,c.wait(300)];case 19:return d.sent(),k.go(e,200,-20,2),[4,c.wait(300)];case 20:return d.sent(),k.go(e,300,-20,2),[4,c.wait(300)];case 21:return d.sent(),k.go(e,400,500,2),[4,c.wait(300)];case 22:return d.sent(),k.go(e,500,500,2),[4,c.wait(300)];case 23:return d.sent(),k.go(e,600,500,2),[4,c.wait(3e3)];case 24:case 25:case 26:case 27:return d.sent(),j.go(e,0,64,-4),[4,c.wait(300)];case 28:return d.sent(),j.go(e,0,64,-4),[4,c.wait(2500)];case 29:return d.sent(),i.go(e,120,0,-4),[4,c.wait(300)];case 30:return d.sent(),i.go(e,50,0,-4),[4,c.wait(300)];case 31:return d.sent(),i.go(e,-20,0,-4),[4,c.wait(2e3)];case 32:return d.sent(),i.go(e,300,0,4),[4,c.wait(300)];case 33:return d.sent(),i.go(e,230,0,4),[4,c.wait(300)];case 34:return d.sent(),i.go(e,160,0,4),[4,c.wait(2e3)];case 35:return d.sent(),l=e.spr("enemy-d1").proxy,l.go(e,200,-100,"right"),l.go(e,400,-200,"left"),l.go(e,200,-300,"right"),l.go(e,400,-400,"left"),l.go(e,100,-500,"down"),l.go(e,500,-500,"down"),[4,c.wait(2e3)];case 36:return d.sent(),m=e.spr("enemy-e1").proxy,m.go(e,0,0,1),[4,c.wait(12e3)];case 37:return d.sent(),m.go(e,0,0,-1),[4,c.wait(12e3)];case 38:return d.sent(),n=e.spr("enemy-f1").proxy,n.go(e),[4,c.wait(2e3)];case 39:case 40:case 41:case 42:return d.sent(),n.go(e),[4,c.wait(2e3)];case 43:return d.sent(),n.go(e),[4,c.wait(500)];case 44:case 45:case 46:case 47:return d.sent(),j.go(e,0,64,4),[4,c.wait(300)];case 48:return d.sent(),j.go(e,0,64,4),[4,c.wait(500)];case 49:case 50:case 51:return d.sent(),n.go(e),[4,c.wait(2e3)];case 52:return d.sent(),n.go(e),[4,c.wait(500)];case 53:case 54:case 55:case 56:return d.sent(),j.go(e,0,-32,-4),[4,c.wait(300)];case 57:return d.sent(),j.go(e,0,-32,-4),[4,c.wait(500)];case 58:case 59:case 60:case 61:case 62:return d.sent(),n.go(e),[4,c.wait(2e3)];case 63:return d.sent(),g.get(h).to({volume:0},2e3).call(function(){h.stop(),c.signal("bgm-fadeout")}),[4,c.wait("bgm-fadeout")];case 64:for(d.sent(),o=1333,p=e.get("stage").y;p<o;)o-=32;return e.sys("stage").wait(0,o,function(){return c.signal("fast-scrolling")}),[4,c.wait("fast-scrolling")];case 65:return d.sent(),e.sys("stage").loop(0,5653,0,o),e.sys("stage").scroll(0,-4),b.libraries.audio.musics.boss.volume=1,b.libraries.audio.musics.boss.play(),[4,c.wait(500)];case 66:return d.sent(),q=e.spr("boss-a1").proxy,q.go(e,320,-128,1),q.go(e,-128,192,1),q.go(e,768,192,1),a.active=!1,[2]}})},a}();b.SceneStage1SpritePlot1=e}),System.registerDynamic("scenes/stage1/stage1.js",[],!0,function(a,b,c){"use strict";this||self;Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){}return a.prototype.onInit=function(a){console.log("on scene init: "+a.name)},a.prototype.onActivate=function(a){console.log("on scene activate: "+a.name);var b=a.game.components.shooting;b.progress=0,b.score=0,b.lives=2,a.reset(),a.systems.stage.setPos(0,6688),a.systems.stage.scroll(0,-1),a.sprites.plot1.active=!0},a.prototype.onDeactivate=function(a){console.log("on scene deactivate: "+a.name),a.game.libraries.audio.musics.battle.stop(),a.game.libraries.audio.musics.boss.stop(),a.game.libraries.audio.musics.win.stop(),a.game.libraries.audio.musics.lose.stop()},a.prototype.onKeyPress=function(a,b){if("Enter"==b){a.paused=!a.paused;var c=a.game.lib("audio").musics.battle,d=a.game.lib("audio").musics.boss;a.paused?(a.get("stage").scrolling=!1,c.isPlaying()&&c.pause(),d.isPlaying()&&d.pause(),a.game.lib("audio").sounds.pause.play()):(a.get("stage").scrolling=!0,c.isPaused()&&c.resume(),d.isPaused()&&d.resume())}},a}();b.SceneStage1=d}),System.registerDynamic("sprites/bar.js",[],!0,function(a,b,c){"use strict";this||self;Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){}return a.prototype.prepareTexture=function(a){var b=a.scene.name+"."+(a.origin?a.origin.name:a.name),c=a.game.lib("image").getTexture(b);if(c)return c;var d=-1;if(a.components["custom-display"]&&a.components["custom-display"].color){var e=a.components["custom-display"].color.toString();e.length>1&&"#"==e.charAt(0)&&(d=parseInt(e.substring(1),16))}var f=new PIXI.Graphics;return f.beginFill(d),f.drawRect(0,0,1,1),f.endFill(),c=f.generateCanvasTexture(),a.game.lib("image").setTexture(b,c),c},a}();b.SpriteBar=d}),System.registerDynamic("sprites/boom.js",[],!0,function(a,b,c){"use strict";this||self;Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){}return a.prototype.onAnimationComplete=function(a){a.active=!1},a}();b.SpriteBoom=d}),System.registerDynamic("sprites/boss-a.js",[],!0,function(a,b,c){"use strict";this||self;Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){}return a.prototype.explode=function(a,b,c){for(var d=a.sys("motion"),e=b.get("display").object,f=e.x,g=e.y,h=0;h<8;h++){var i=a.getFreeSprite("enemy-bullet-a1");if(!i)break;i.components.display.object.x=f,i.components.display.object.y=g,d.moveOutside(i,c,360-45*h,-8,-8,648,488,function(a){return a.active=!1}),i.active=!0}},a.prototype.sendBomb=function(a,b,c){var d=this;if(b.active){var e=a.game.lib("script"),f=a.sys("motion"),g=a.systems.tween,h=a.spr("player1").get("display").object,i=b.get("display").object.x,j=b.get("display").object.y,k=f.getMotionAngle(i,j+20,h.x,h.y),l=e.call(this,"getFreeEnemy",a,"boss-bomb-a1");l&&(l.components.display.object.tint=16777215,l.components.display.object.x=i+10*(k>270?1:-1),l.components.display.object.y=j+20,f.moveOutside(l,c,k,-8,-8,648,488,function(a){return a.active=!1}),a.timeout(1e3+Math.round(100*Math.random())%4*1e3,function(){g.get(l.components.display.object).to({tint:16742263},200).wait(300).call(function(){l.active&&(l.active=!1)})}),void 0==l.components.event&&(l.components.event={}),l.components.event.onDeactivate=function(b){return d.explode(a,b,2)},l.active=!0),a.timeout(2e3+Math.round(100*Math.random())%4*1e3,function(){return d.sendBomb(a,b,c)})}},a.prototype.move=function(a,b,c){var d=this;if(b.active){var e=a.sys("motion"),f=a.game.lib("json"),g=f.getJson("json/paths/boss.json");if(null!=g){var h=b.get("display").object;e.applyPath(b,h.x,h.y,c,g.nodes,function(b){return d.move(a,b,0-c)})}}},a.prototype.go=function(a,b,c,d){var e=this,f=a.game.lib("script"),g=a.sys("motion"),h=f.call(this,"getFreeEnemy",a,"boss-a1");if(h){var i=0,j=0;c<0?(i=b,j=c+256,h.active=!0):b<0?(i=b+256,j=c,h.active=!0):b>0&&c>0?(i=b-256,j=c,h.active=!0):h.active=!1,h.active&&(h.components.display.object.x=b,h.components.display.object.y=c,g.moveTo(h,i,j,2*d,function(b){e.move(a,b,d),b.active&&e.sendBomb(a,b,1)}),void 0==h.components.event&&(h.components.event={}),h.components.event.onDeactivate=function(b){var c=h.game.components.shooting;c.progress=c.progress+35,c.progress>=100&&(console.log("stage clear"),a.spr("game-over1").active=!0)})}},a}();b.SpriteBossA=d}),System.registerDynamic("sprites/enemy-a.js",[],!0,function(a,b,c){"use strict";this||self;Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){}return a.prototype.fire=function(a,b,c,d){var e=a.systems.motion,f=a.sprites.player1.get("display").object,g=e.getMotionAngle(b,c,f.x,f.y),h=a.getFreeSprite("enemy-bullet-a1");null!=h&&(h.components.display.object.x=b+4*(g>270?1:-1),h.components.display.object.y=c+8,e.moveOutside(h,d,g,-8,-8,648,488,function(){return h.active=!1}),h.active=!0)},a.prototype.go=function(a,b,c,d){var e=this,f=a.systems.motion,g=a.game.libraries.script,h=a.game.libraries.json,i=h.getJson("json/paths/deepv.json");if(void 0!=i&&null!=i){var j=g.call(this,"getFreeEnemy",a,"enemy-a1");j&&(j.components.display.animation.reset("down"),j.components.display.animation.play(),f.applyPath(j,b,c,d,i.nodes,function(a){return j.active=!1},function(a,b,c,d){1==b&&(a.components.display.animation.reset("up"),a.components.display.animation.play(!1))}),j.active=!0,a.timeout(500+Math.round(100*Math.random())%4*500,function(){if(0!=j.active){var b=j.get("display").object;e.fire(a,b.x,b.y+16,Math.round(Math.abs(d)+1))}}))}},a}();b.SpriteEnemyA=d}),System.registerDynamic("sprites/enemy-b.js",[],!0,function(a,b,c){"use strict";this||self;Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){}return a.prototype.go=function(a,b,c,d){var e=a.sys("motion"),f=a.game.lib("script"),g=a.game.lib("json"),h=g.getJson("json/paths/circle.json");if(void 0!=h&&null!=h){var i=f.call(this,"getFreeEnemy",a,"enemy-b1");i&&(e.applyPath(i,b,c,d,h.nodes,function(a){return i.active=!1},function(a,b,c,d){var e=a.components.display.object;e.rotation=Math.atan2(d-e.y,c-e.x)}),i.active=!0)}},a}();b.SpriteEnemyB=d}),System.registerDynamic("sprites/enemy-c.js",[],!0,function(a,b,c){"use strict";this||self;Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){}return a.prototype.tracePlayer=function(a,b,c){var d=this,e=a.sys("motion"),f=a.spr("player1"),g=b.get("display").object,h=f.get("display").object,i=g.x,j=g.y,k=h.x,l=h.y;g.rotation=Math.atan2(l-j,k-i),!f.active||0==f.components.collision.enabled||(i-k)*(i-k)+(j-l)*(j-l)<=1e4?e.moveOutside(b,c,e.getMotionAngle(i,j,k,l),-32,-32,672,512,function(a){return a.enabled=!1}):(e.moveTo(b,k,l,c),a.timeout(500,function(){b.active&&d.tracePlayer(a,b,c)}))},a.prototype.go=function(a,b,c,d){var e=a.game.lib("script"),f=e.call(this,"getFreeEnemy",a,"enemy-c1");f&&(f.components.display.object.x=b,f.components.display.object.y=c,f.active=!0,this.tracePlayer(a,f,d))},a}();b.SpriteEnemyC=d}),System.registerDynamic("sprites/enemy-d.js",[],!0,function(a,b,c){"use strict";this||self;Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){}return a.prototype.fire=function(a,b,c){var d=this;a.timeout(2e3,function(){if(b.active){for(var e=a.sys("stage"),f=a.sys("motion"),g=b.get("stage"),h=g.x,i=g.y,j=b.get("display").animation.current,k=0;k<3;k++)a.timeout(80*(k+1),function(){if(b.active){var d=a.getFreeSprite("enemy-bullet-b1");d&&(d.active=!0,"left"==j?(e.setSpritePos(d,h-20,i),f.moveTo(d,-20,i,c,function(a){return a.active=!1})):"right"==j?(e.setSpritePos(d,h+20,i),f.moveTo(d,660,i,c,function(a){return a.active=!1})):(e.setSpritePos(d,h,i+20),f.moveTo(d,h,a.get("stage").y+480+240,c,function(a){return a.active=!1})))}});a.timeout(2e3,function(){return d.fire(a,b,c)})}})},a.prototype.go=function(a,b,c,d){var e=a.game.lib("script"),f=e.call(this,"getFreeEnemy",a,"enemy-d1"),g=a.sys("stage");f&&(f.components.shooting.hp=f.components.shooting.maxhp,f.components.display.animation.set(d),g.setSpritePos(f,a.get("stage").x+b,a.get("stage").y+c),a.timeout(2e4,function(){return f.active=!1}),f.active=!0,this.fire(a,f,4))},a}();b.SpriteEnemyD=d}),System.registerDynamic("sprites/enemy-e.js",[],!0,function(a,b,c){"use strict";this||self;Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){}return a.prototype.fire=function(a,b,c){var d=this,e=a.sys("motion");a.timeout(1e3,function(){if(b.active){for(var f=b.get("display").object,g=f.x,h=f.y,i=0;i<5;i++){var j=a.getFreeSprite("enemy-bullet-a1");if(!j)break;j.active=!0,j.components.display.object.x=g,j.components.display.object.y=h+28;var k=360-30*(i+1);0==i?k=315:1==i?k=295:3==i?k=245:4==i&&(k=225),e.moveOutside(j,c,k,-8,-8,648,488,function(a){return a.active=!1})}a.timeout(1e3,function(){return d.fire(a,b,c)})}})},a.prototype.go=function(a,b,c,d){var e=a.sys("motion"),f=a.game.lib("script"),g=a.game.lib("json"),h=g.getJson("json/paths/hill.json");if(void 0!=h&&null!=h){var i=f.call(this,"getFreeEnemy",a,"enemy-e1");i&&(i.active=!0,i.components.shooting.hp=i.components.shooting.maxhp,e.applyPath(i,b,c,d,h.nodes,function(a){a.active&&e.applyPath(a,b,c,0-d,h.nodes,function(a){return a.active=!1})}),this.fire(a,i,4))}},a}();b.SpriteEnemyE=d}),System.registerDynamic("sprites/enemy-f.js",[],!0,function(a,b,c){"use strict";this||self;Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){}return a.prototype.go=function(a){var b=a.game.lib("script"),c=a.sys("motion"),d=a.spr("player1"),e=d.get("display").object,f=e.x,g=(e.y,f+Math.round(32*Math.random())*(Math.random()>.5?1:-1)),h=b.call(this,"getFreeEnemy",a,"enemy-f1");null!=h&&(h.components.display.object.x=g,h.components.display.object.y=-20,c.moveTo(h,g,520,2,function(a){return a.active=!1},function(a,b,c){var d=a.get("motion");b%64==0&&d.speed<32&&(d.speed=2*d.speed)}),h.active=!0)},a}();b.SpriteEnemyF=d}),System.registerDynamic("sprites/enemy.js",[],!0,function(a,b,c){"use strict";this||self;Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){}return a.prototype.getFreeEnemy=function(a,b){var c=a.getFreeSprite(b);return c&&c.components.shooting&&c.components.shooting.maxhp&&(c.components.shooting.hp=c.components.shooting.maxhp),c},a}();b.SpriteEnemy=d}),System.registerDynamic("sprites/fps.js",[],!0,function(a,b,c){"use strict";this||self;Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){}return a.prototype.onUpdate=function(a){var b=a.components.display;b&&b.object&&(b.object.text=Math.round(a.game.fps).toString())},a}();b.SpriteFps=d}),System.registerDynamic("sprites/game-over.js",[],!0,function(a,b,c){"use strict";var d=(this||self,b&&b.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(a){c=[6,a],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h});Object.defineProperty(b,"__esModule",{value:!0});var e=function(){function a(){}return a.prototype.onUpdate=function(a){var b,c,e,f,g,h,i,j,k,l,m,n;return d(this,function(d){switch(d.label){case 0:return console.log("plot started - "+a.name),b=a.game,c=a.plot,e=a.scene,f=e.systems.tween,g=e.systems.motion,h=b.components.shooting,i=e.sprites.player1,[4,c.wait(100)];case 1:return d.sent(),(j=e.game.libraries.audio.musics.battle,k=e.game.libraries.audio.musics.boss,l=e.game.libraries.audio.musics.win,m=e.game.libraries.audio.musics.lose,0==h.progress)?[3,5]:(i&&(i.components.collision.enabled=!1),j.isPlaying()?(f.get(j).to({volume:0},2e3).call(function(){j.stop(),c.signal("bgm-fadeout")}),[4,c.wait("bgm-fadeout")]):[3,3]);case 2:return d.sent(),[3,5];case 3:return k.isPlaying()?(f.get(k).to({volume:0},2e3).call(function(){k.stop(),c.signal("bgm-fadeout")}),[4,c.wait("bgm-fadeout")]):[3,5];case 4:d.sent(),d.label=5;case 5:return h.progress>0?(l.play(1),e.spr("info1").get("display").object.text="STAGE CLEAR",e.spr("info1").active=!0):h.progress<0&&(m.play(1),e.spr("info1").get("display").object.text="GAME OVER",e.spr("info1").active=!0),0==h.progress?[3,7]:[4,c.wait(6e3)];case 6:d.sent(),n=a.scene.systems.transition,n&&n.callScene("menu"),d.label=7;case 7:return a.active=!1,[2]}})},a}();b.SpriteGameOver=e}),System.registerDynamic("sprites/reborn.js",[],!0,function(a,b,c){"use strict";var d=(this||self,b&&b.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(a){c=[6,a],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h});Object.defineProperty(b,"__esModule",{value:!0});var e=function(){function a(){}return a.prototype.onUpdate=function(a){var b,c,e,f,g;return d(this,function(d){return console.log("plot started - "+a.name),b=a.scene,c=b.systems.tween,e=b.systems.motion,f=b.game.components.shooting,g=b.sprites.player1,f.lives<=0?(f.progress=-1e3,console.log("jump to gameover..."),b.spr("game-over1").active=!0):(f.lives=f.lives-1,f.bombs=2,f.level=1,f.hp=100,f.controllable=!1,g.components.display.object.x=320,g.components.display.object.y=630,g.components.display.object.alpha=1,g.components.display.object.tint=16777215,g.components.collision.enabled=!1,g.active=!0,c.blink(g.components.display.object,3e3,function(){return g.components.collision.enabled=!0}),e.moveTo(g,320,350,10,function(){return f.controllable=!0})),a.active=!1,[2]})},a}();b.SpriteReborn=e}),System.registerDynamic("systems/shooting.js",[],!0,function(a,b,c){"use strict";this||self;Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){this.name="shooting",this.collision=null,this.keyboard=null,this.motion=null,this.tween=null,this.audio=null,this.player=null,this.profile=null}return a.prototype.init=function(a){var b=this;return this.collision=a.systems.collision,this.profile=a.components.shooting,this.collision&&(this.collision.onCollision=function(a,c){return b.handleCollision(a,c)}),this.collision?console.log("shooting system is loaded successfully"):console.log("failed to load shooting system (missing collision detection)"),!0},a.prototype.activate=function(a){this.player=null,this.keyboard=a.systems.keyboard,this.motion=a.systems.motion,this.tween=a.systems.tween,this.audio=a.game.libraries.audio;var b=a.components.shooting;b&&b.player&&(this.player=a.sprites[b.player])},a.prototype.update=function(a,b){this.handleKeyboard(a),this.collision&&this.collision.update(a,b),this.updatePlayerInfoDisplay(a)},a.prototype.updatePlayerInfoDisplay=function(a){void 0!=this.profile&&null!=this.profile&&(a.spr("bar1").get("display").object.scale.x=250*this.profile.hp/100,a.spr("label1").get("display").object.text="x"+this.profile.lives,a.spr("label2").get("display").object.text="x"+this.profile.bombs,a.spr("label3").get("display").object.text="Score: "+this.profile.score)},a.prototype.handleKeyboard=function(a){var b=this;if(!a.paused&&void 0!=this.keyboard&&null!=this.keyboard&&void 0!=this.player&&null!=this.player&&void 0!=this.profile&&null!=this.profile&&!0===this.profile.controllable){var c=window.vjoystick;if(c){var d=c.up(),e=c.down(),f=c.left(),g=c.right();d||e||f||g?(this.keyboard.states.ArrowUp=d,this.keyboard.states.ArrowDown=e,this.keyboard.states.ArrowLeft=f,this.keyboard.states.ArrowRight=g):(this.keyboard.states.ArrowUp=!1,this.keyboard.states.ArrowDown=!1,this.keyboard.states.ArrowLeft=!1,this.keyboard.states.ArrowRight=!1),this.keyboard.states.Control=!0===c.b1,this.keyboard.states.Shift=!0===c.b2}var h=this.player.components.display;if(this.player.active&&h&&h.object){var i=4,j=0,k=0;if(this.keyboard.states.ArrowUp&&(k-=i),this.keyboard.states.ArrowDown&&(k+=i),this.keyboard.states.ArrowLeft&&(j-=i),this.keyboard.states.ArrowRight&&(j+=i),0!=j||0!=k){var l=h.object.getBounds(!1);l.left+j>0&&l.right+j<a.game.width&&l.top+k>0&&l.bottom+k<a.game.height-25&&(h.object.x+=j,h.object.y+=k)}if(this.keyboard.states.Control){if((this.keyboard.ticks.Control?a.ticks-this.keyboard.ticks.Control:a.ticks)>=120){var m=a.getFreeSprite("player-bullet-a1"),n=m?m.components.display.object:null;m&&n&&this.motion&&(n.x=h.object.x,n.y=h.object.y-40,m.active=!0,this.motion.moveTo(m,n.x,-40,8,function(a){return a.active=!1}),this.audio&&this.audio.sounds.shoot.play()),this.keyboard.ticks.Control=a.ticks}}if(this.keyboard.states.Shift&&this.profile&&this.profile.bombs>0&&a.getFreeSpriteCount("player-bomb1")>=3){this.profile.bombs=this.profile.bombs-1;for(var o=h.object.x-80,p=688,q=0;q<3;q++){var r=a.getFreeSprite("player-bomb1"),n=r?r.components.display.object:null;if(!r||!n)break;n.x=o,n.y=p,r.active=!0,this.motion.moveTo(r,o,h.object.y-48,8,function(c){a.timeout(8e3,function(){b.motion.moveTo(c,c.get("display").object.x,-60,8,function(a){return a.active=!1})})}),o+=80}}}}},a.prototype.handleCollision=function(a,b){if(void 0!=this.profile&&null!=this.profile&&0!=a.active&&0!=b.active){var c=null,d=null,e=null,f=null,g=null;if(a.components.shooting&&b.components.shooting){switch(a.components.shooting.role){case"player":c=a;break;case"player-bullet":d=a;break;case"enemy":e=a;break;case"enemy-bullet":f=a;break;case"friend":g=a}switch(b.components.shooting.role){case"player":c=b;break;case"player-bullet":d=b;break;case"enemy":e=b;break;case"enemy-bullet":f=b;break;case"friend":g=b}}if(e){var h=e.components.display.object;if(h.y-h.height/2<=0||h.x+h.width/4<=0)return}if(c&&e?(this.profile.hp-=e.components.shooting.power,this.profile.hp<0&&(this.profile.hp=0),e.components.shooting.hp-=this.profile.power,e.components.shooting.hp<0&&(e.components.shooting.hp=0)):c&&f?(this.profile.hp-=f.components.shooting.power,this.profile.hp<0&&(this.profile.hp=0),f.active=!1):e&&d?(e.components.shooting.hp-=d.components.shooting.power,e.components.shooting.hp<0&&(e.components.shooting.hp=0),d.active=!1):g&&f&&(f.active=!1),e&&(c||d))if(e.components.shooting.hp>0)this.tween.get(e.components.display.object).set({tint:16742263}).wait(200).set({tint:16777215}),this.audio&&this.audio.sounds.hit.play();else{var i=e.scene.getFreeSprite(e.components.shooting.boom+"1"),h=i?i.get("display"):null;i&&h&&(h.object.x=e.components.display.object.x,h.object.y=e.components.display.object.y,h.animation.onComplete=null,h.animation.reset(),h.animation.play(!1),i.active=!0),this.profile.score+=e.components.shooting.score,this.audio&&("boom-a"==e.components.shooting.boom?this.audio.sounds.boom1.play():this.audio.sounds.boom2.play()),e.active=!1}if(c&&(e||f))if(this.profile.hp>0)this.tween.get(c.components.display.object).set({tint:16742263}).wait(200).set({tint:16777215});else{var i=c.scene.getFreeSprite("boom-b1"),h=i?i.get("display"):null;i&&h&&(h.object.x=c.components.display.object.x,h.object.y=c.components.display.object.y,h.animation.onComplete=function(a){a.active=!1,a.scene.spr("reborn1").active=!0},h.animation.reset(),h.animation.play(!1),i.active=!0),this.audio&&this.audio.sounds.boom2.play(),c.active=!1}}},a}();b.Shooting=d});